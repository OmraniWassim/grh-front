<div class="card card-w-title">
  <p-breadcrumb [model]="breadcrumbItems" [home]="{icon: 'pi pi-home'}"></p-breadcrumb>
</div>
<ng-form #addForm="ngForm">
  <p-card header="{{'Informations Collaborateur'|translate}}">
    <div class="card p-fluid">
      <div class="p-formgrid grid">
        <div class="field col">
          <label for="cin">CIN*</label>
          <input pInputText id="cin" name="cin" type="number" [(ngModel)]="cin" required pattern="\d{8}" />
          <div
            *ngIf="addForm.controls['cin'].invalid && (addForm.controls['cin'].dirty || addForm.controls['cin'].touched)">
            <small class="text-danger" *ngIf="addForm.controls['cin'].errors?.required">CIN is required.</small>
            <small class="text-danger" *ngIf="addForm.controls['cin'].errors?.pattern">CIN must be 8 digits.</small>
          </div>
        </div>
        <div class="field col">
          <label for="nomComplet">{{"Nom Complet"|translate}}*</label>
          <input pInputText id="nomComplet" name="nomComplet" type="text" [(ngModel)]="nomComplet" required />
        </div>
      </div>
      <div class="p-formgrid grid">
        <div class="field col">
          <label for="numCompte">{{"Num Compte"|translate}}*</label>
          <input pInputText id="numCompte" name="numCompte" type="number" [(ngModel)]="numCompte" required
            pattern="\d{13}" />
          <div
            *ngIf="addForm.controls['numCompte'].invalid && (addForm.controls['numCompte'].dirty || addForm.controls['numCompte'].touched)">
            <small class="text-danger" *ngIf="addForm.controls['numCompte'].errors?.required">{{"Num Compte is
              required"|translate}}.</small>
            <small class="text-danger" *ngIf="addForm.controls['numCompte'].errors?.pattern">{{"Num Compte must be 13
              digits"| translate}}.</small>
          </div>

        </div>
        <div class="field col">
          <label for="numSecuriteSociale">{{"Num Securite Sociale"|translate}}</label>
          <input pInputText id="numSecuriteSociale" name="numSecuriteSociale" type="number"
            [(ngModel)]="numSecuriteSociale" pattern="\d{15}" />
          <div
            *ngIf="addForm.controls['numSecuriteSociale'].invalid && (addForm.controls['numSecuriteSociale'].dirty || addForm.controls['numSecuriteSociale'].touched)">
            <small class="text-danger" *ngIf="addForm.controls['numSecuriteSociale'].errors?.pattern">{{"Num securite
              sociale must be 15 digits"|translate}}.</small>
          </div>
        </div>

      </div>
      <div class="p-formgrid grid">
        <div class="field col">
          <label for="dateNaissance">{{"Date Naissance"|translate}}*</label>
          <p-calendar [showIcon]="true" inputId="dateNaissance" name="dateNaissance" [required]="true"
            [(ngModel)]="dateNaissance" dateFormat="dd/mm/yy" [maxDate]="maxDate"></p-calendar>
        </div>
        <div class="field col">
          <label for="numTelephone">{{"Num Telephone"|translate}}*</label>
          <input pInputText id="numTelephone" name="numTelephone" type="number" [(ngModel)]="numTelephone" required />
        </div>
      </div>
      <div class="p-formgrid grid">
        <div class="field col">
          <label for="adresse">{{"Adresse"|translate}}</label>
          <input pInputText id="adresse" name="adresse" type="text" [(ngModel)]="adresse" />
        </div>
        <div class="field col">
          <label for="email">Email</label>
          <input pInputText id="email" name="email" type="email"
            pattern="[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$" [(ngModel)]="email" mail />
          <div
            *ngIf="addForm.controls['email'].invalid && (addForm.controls['email'].dirty || addForm.controls['email'].touched)">
            <small class="text-danger" *ngIf="addForm.controls['email'].errors?.required">maile is required.</small>
            <small class="text-danger" *ngIf="addForm.controls['email'].errors?.pattern">mail is not valid.</small>
          </div>
        </div>
      </div>
    </div>
  </p-card>
  <br>
  <p-card header="{{'Qualification'|translate}}">
    <div class="card p-fluid">
      <div class="p-formgrid grid">
        <div class="field col">
          <label for="natureEtude">{{"Nature d'Etude"|translate}}*</label>
          <p-dropdown id="natureEtude" name="natureEtude" [options]="natureEtudeOptions"
            [(ngModel)]="selectedNatureEtude" [required]="true"></p-dropdown>
        </div>
        <div class="field col">
          <label for="certifications">Certifications</label>
          <input pInputText id="certifications" name="certifications" type="text" [(ngModel)]="certifications" />
        </div>
      </div>
      <div class="p-formgrid grid">
        <div class="field col">
          <label for="niveauEtude">{{"Niveau d'Etude"|translate}}*</label>
          <p-dropdown id="niveauEtude" name="niveauEtude" [options]="niveauEtudeOptions"
            [(ngModel)]="selectedNiveauEtude" [required]="true"></p-dropdown>
        </div>
        <div class="field col">
          <label for="anneeExperience">{{"Years of Experience"|translate}}*</label>
          <input pInputText id="anneeExperience" name="anneeExperience" type="text" [(ngModel)]="anneeExperience"
            [required]="true" />
        </div>
      </div>
    </div>
  </p-card>
  <br>

  <p-card header="{{'Contrat'|translate}}">
    <div class="card p-fluid">
      <div class="p-formgrid grid">
        <div class="field col">
          <label>{{"Type de Contrat"|translate}}*</label>
          <p-dropdown id="typeContrat" name="typeContrat" (onChange)="OnSelectType()" [options]="contractTypesList"
            [(ngModel)]="selectedTypeContrat" placeholder="choisir un type de contrat"></p-dropdown>
        </div>
        <div class="field col">
          <label>{{"Salaire de Base"|translate}}*</label>
          <input pInputText id="salaireDeBase" name="salaireDeBase" [required]="true" type="number"
            [(ngModel)]="salaireDeBase" />
        </div>
      </div>
      <div class="p-formgrid grid">
        <div class="field col">
          <label>{{"Avantage sur Salaire"|translate}}</label>
          <p-dropdown id="avantageSalaire" name="avantageSalaire" [options]="avantages"
            [(ngModel)]="selectedAvantage"></p-dropdown>
        </div>
        <div class="field col">
          <label>{{"Date DÃ©but de Contrat"|translate}}</label>
          <p-calendar [showIcon]="true" id="dateDebutContrat" name="dateDebutContrat"
            [(ngModel)]="dateDebutContrat"></p-calendar>
        </div>
      </div>
      <div *ngIf="selectedTypeContrat === 'CDD'" class="p-formgrid grid">
        <div class="field col">
          <label>{{"Date fin de Contrat"|translate}}</label>
          <p-calendar [showIcon]="true" id="dateDebutContrat" [minDate]="dateDebutContrat" name="dateFinContrat"
            [(ngModel)]="dateFintContrat"></p-calendar>
        </div>
      </div>
    </div>
  </p-card>
  <br>

  <p-card header="Grade">
    <div class="card p-fluid">
      <div class="p-formgrid grid">
        <div class="field col">
          <label>Departement*</label>
          <p-dropdown [options]="departmentsList" (onChange)="onDepartementChange($event.value)"
            placeholder="choisir departement" [(ngModel)]="selectedDepartement"></p-dropdown>
        </div>
        <div class="field col">
          <label>{{"Poste"|translate}}*</label>
          <p-dropdown id="poste" name="poste" [options]="postes" (onChange)="onPosteChange($event)"
            [(ngModel)]="selectedPoste" placeholder="choisir le poste"></p-dropdown>
        </div>
      </div>
      <div class="p-formgrid grid">
        <div *ngIf="showResponsableDropdown === true" class="field col">
          <label>Responsable</label>
          <p-dropdown id="responsable" name="responsable" [options]="responsables" [(ngModel)]="selectedResponsable"
            placeholder="choisir un responsable"></p-dropdown>
        </div>
      </div>
    </div>

  </p-card>
  <br>

  <p-card header="{{'Pieces Jointes'|translate}}" class="pieces-card">
    <div class="card p-fluid">
      <p-fileUpload mode="basic" chooseLabel="Choose" [auto]="true" name="demo[]"
        url="https://www.primefaces.org/cdn/api/upload.php" accept=".pdf" [maxFileSize]="4 * 1024 * 1024"
        (onUpload)="onBasicUpload($event)"></p-fileUpload> <p-table [value]="documents">
        <ng-template pTemplate="header">
          <tr>
            <th>Documents</th>
            <th>{{"Obligatoire"|translate}}</th>
            <th>Status</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-document>
          <tr>
            <td>{{ document.name }}</td>
            <td>
              <ng-container *ngIf="obligedDocuments.includes(document.name)">{{"oui"|translate}}</ng-container>
              <ng-container *ngIf="!obligedDocuments.includes(document.name)">{{"non"|translate}}</ng-container>
            </td>
            <td>
              <p-checkbox [binary]="true" [disabled]="obligedDocuments.includes(document.name)"></p-checkbox>
            </td>
          </tr>
        </ng-template>
      </p-table>


    </div>
  </p-card>
  <br>

  <p-card header="{{'Autre Informations'|translate}}">
    <div class="card p-fluid">
      <div class="p-formgrid grid">
        <div class="field-checkbox">
          <p-checkbox name="group1" value="true" [(ngModel)]="recommendation" id="recommendation"></p-checkbox>
          <label for="recommendation" class="ml-2">Recommendation</label>
        </div>
        <div *ngIf="recommendation != false" class="col-12 md:col-6">
          <label>{{"Collaborateur"|translate}}</label>
          <p-autoComplete id="collaborateurs" name="collaborateurs" type="text" [(ngModel)]="selectedCollabName"
            [suggestions]="collaborateursListFinal" (completeMethod)="search($event)"></p-autoComplete>

        </div>
        <div *ngIf="recommendation != false" class="col-12 md:col-4">
          <label class="block text-sm font-medium text-gray-700">{{"Comment"|translate}}</label>
          <textarea pInputTextarea id="comment" name="comment" [(ngModel)]="comment" class="mt-1 p-2"></textarea>
        </div>
      </div>
    </div>
  </p-card>
  <p></p>
  <div class="modal-footer d-flex text-right">
    <button pButton pRipple label="{{'Initialiser'|translate}}" (click)="resetForm(addForm)" icon="pi pi-times"
      class="p-button-text"></button>
    <button [disabled]="addForm.invalid" (click)="addCollaborator(addForm)" pButton pRipple
      label="{{'Enregistrer'|translate}}" icon="pi pi-check" class="p-button-text"></button>
  </div>


</ng-form>

<p-toast></p-toast>